

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>GSForge.operations.normalizations module &mdash; gsforge v0.6beta documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/togglebutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/mystnb.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="GSForge.operations.prospectors module" href="GSForge.operations.prospectors.html" />
    <link rel="prev" title="GSForge.operations.core module" href="GSForge.operations.core.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> gsforge
          

          
          </a>

          
            
            
              <div class="version">
                0.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">User Guide / Tutorial:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html"> Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/tour.html"> Tour</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/gem_creation.html"> Annotated Expression Matrix Creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/set_and_collection_creation.html"> Set and Collection Creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/Interface_Guide.html"> Interface Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/Plotting_Guide.html"> Plotting Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/R_integration.html"> R Integration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/analysis_resources.html"> Analysis Resources</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference_examples/plot_gallery/ref_plots.html"> Reference Plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_examples/Normalizations/norm_index.html"> Normalization Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Walkthroughs:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../walkthroughs/oryza_sativa/oryza_sativa_index.html"> Oryza sativa</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="GSForge.html">GSForge package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="GSForge.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="GSForge.models.html">GSForge.models package</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="GSForge.operations.html">GSForge.operations package</a></li>
<li class="toctree-l4"><a class="reference internal" href="GSForge.plots.html">GSForge.plots package</a></li>
<li class="toctree-l4"><a class="reference internal" href="GSForge.utils.html">GSForge.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="GSForge.html#module-GSForge">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">gsforge</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">GSForge</a> &raquo;</li>
        
          <li><a href="GSForge.html">GSForge package</a> &raquo;</li>
        
          <li><a href="GSForge.operations.html">GSForge.operations package</a> &raquo;</li>
        
      <li>GSForge.operations.normalizations module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/API/GSForge.operations.normalizations.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="module-GSForge.operations.normalizations">
<span id="gsforge-operations-normalizations-module"></span><h1>GSForge.operations.normalizations module<a class="headerlink" href="#module-GSForge.operations.normalizations" title="Permalink to this headline">¶</a></h1>
<p>Normalization functions inherit from the <code class="docutils literal notranslate"><span class="pre">OperationInterface</span></code> class.
This means that they can all be called upon an <code class="docutils literal notranslate"><span class="pre">AnnotatedGEM</span></code> or a <code class="docutils literal notranslate"><span class="pre">GeneSetCollection</span></code>.</p>
<p>These (classes) functions have static methods that implement the transform on a <code class="docutils literal notranslate"><span class="pre">numpy</span></code>
or <code class="docutils literal notranslate"><span class="pre">xarray</span></code> source.</p>
<dl class="py class">
<dt class="sig sig-object py" id="GSForge.operations.normalizations.ReadsPerKilobaseMillion">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">GSForge.operations.normalizations.</span></span><span class="sig-name descname"><span class="pre">ReadsPerKilobaseMillion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#GSForge.operations.normalizations.ReadsPerKilobaseMillion" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="GSForge.models.html#GSForge.models.Interface" title="GSForge.models._Interface.Interface"><code class="xref py py-class docutils literal notranslate"><span class="pre">GSForge.models._Interface.Interface</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">param.parameterized.ParameterizedFunction</span></code></p>
<p>RPKM or FPKM – Reads or Fragments per per Kilobase Million.</p>
<p>These methods attempt to compensate for sequencing depth and gene length.
The utility of this method is disputed in the literature [cite me].</p>
<p>Parameters inherited from:</p>
<blockquote>
<div><p><a class="reference internal" href="GSForge.models.html#GSForge.models.Interface" title="GSForge.models._Interface.Interface"><code class="xref py py-class docutils literal notranslate"><span class="pre">GSForge.models._Interface.Interface</span></code></a>: gem, gene_set_collection, selected_gene_sets, selected_genes, gene_set_mode, sample_subset, count_variable, annotation_variables, count_mask, annotation_mask, count_transform</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">length_variable</span></code> = param.String(readonly=False)</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="GSForge.operations.normalizations.ReadsPerKilobaseMillion.length_variable">
<span class="sig-name descname"><span class="pre">length_variable</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'lengths'</span></em><a class="headerlink" href="#GSForge.operations.normalizations.ReadsPerKilobaseMillion.length_variable" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="GSForge.operations.normalizations.ReadsPerKilobaseMillion.xr_reads_per_kilobase_million">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">xr_reads_per_kilobase_million</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lengths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Sample'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#GSForge.operations.normalizations.ReadsPerKilobaseMillion.xr_reads_per_kilobase_million" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="GSForge.operations.normalizations.ReadsPerKilobaseMillion.np_reads_per_kilobase_million">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">np_reads_per_kilobase_million</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lengths</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#GSForge.operations.normalizations.ReadsPerKilobaseMillion.np_reads_per_kilobase_million" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="GSForge.operations.normalizations.ReadsPerKilobaseMillion.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'ReadsPerKilobaseMillion'</span></em><a class="headerlink" href="#GSForge.operations.normalizations.ReadsPerKilobaseMillion.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="GSForge.operations.normalizations.UpperQuartile">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">GSForge.operations.normalizations.</span></span><span class="sig-name descname"><span class="pre">UpperQuartile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#GSForge.operations.normalizations.UpperQuartile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="GSForge.models.html#GSForge.models.Interface" title="GSForge.models._Interface.Interface"><code class="xref py py-class docutils literal notranslate"><span class="pre">GSForge.models._Interface.Interface</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">param.parameterized.ParameterizedFunction</span></code></p>
<p>Under this normalization method, after removing genes having zero read counts for all samples,
the remaining gene counts are divided by the upper quartile of counts different from zero in
the computation of the normalization factors associated with their sample and multiplied by
the mean upper quartile across all samples of the dataset. <a class="reference internal" href="#method-compare" id="id1"><span>[method_compare]</span></a></p>
<p>Original R code.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">uq</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">X</span><span class="p">){</span>

  <span class="c1">#excluding zero counts in each sample</span>
  <span class="n">UQ</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">y</span><span class="p">){</span>
    <span class="n">quantile</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="n">X</span><span class="o">&lt;-</span><span class="n">X</span><span class="o">+</span><span class="mf">0.1</span>
  <span class="n">upperQ</span><span class="o">&lt;-</span><span class="n">apply</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">UQ</span><span class="p">)</span>
  <span class="n">f</span><span class="o">.</span><span class="n">uq</span><span class="o">&lt;-</span><span class="n">upperQ</span><span class="o">/</span><span class="n">mean</span><span class="p">(</span><span class="n">upperQ</span><span class="p">)</span>
  <span class="n">upq</span><span class="o">.</span><span class="n">res</span><span class="o">&lt;-</span><span class="n">scale</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">center</span><span class="o">=</span><span class="n">FALSE</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">uq</span><span class="p">)</span>
  <span class="k">return</span><span class="p">(</span><span class="n">upq</span><span class="o">.</span><span class="n">res</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="citation">
<dt class="label" id="method-compare"><span class="brackets"><a class="fn-backref" href="#id1">method_compare</a></span></dt>
<dd><p><a class="reference external" href="https://doi.org/10.1371/journal.pone.0176185">A comparison of per sample global scaling and per gene normalization methods for differential expression analysis of RNA-seq data</a></p>
</dd>
</dl>
<p>Parameters inherited from:</p>
<blockquote>
<div><p><a class="reference internal" href="GSForge.models.html#GSForge.models.Interface" title="GSForge.models._Interface.Interface"><code class="xref py py-class docutils literal notranslate"><span class="pre">GSForge.models._Interface.Interface</span></code></a>: gem, gene_set_collection, selected_gene_sets, selected_genes, gene_set_mode, sample_subset, count_variable, annotation_variables, count_mask, annotation_mask, count_transform</p>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="GSForge.operations.normalizations.UpperQuartile.np_upper_quartile">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">np_upper_quartile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">counts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#GSForge.operations.normalizations.UpperQuartile.np_upper_quartile" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the upper quartile normalization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>counts</strong> – A numpy array containing the raw count values. The shape is assumed to be
(samples by genes). Zero counts are expected to be present as zeros.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The upper quartile normalized count matrix.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="GSForge.operations.normalizations.UpperQuartile.xr_upper_quartile">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">xr_upper_quartile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">counts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#GSForge.operations.normalizations.UpperQuartile.xr_upper_quartile" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the upper quartile normalization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>counts</strong> – An <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code> containing the raw count values. The shape is
assumed to be (samples by genes). Zero counts are expected to be present as zeros.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The upper quartile normalized count matrix.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="GSForge.operations.normalizations.UpperQuartile.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'UpperQuartile'</span></em><a class="headerlink" href="#GSForge.operations.normalizations.UpperQuartile.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="GSForge.operations.prospectors.html" class="btn btn-neutral float-right" title="GSForge.operations.prospectors module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="GSForge.operations.core.html" class="btn btn-neutral float-left" title="GSForge.operations.core module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Tyler Biggs, Stephen Ficklin.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>