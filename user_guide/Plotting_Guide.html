

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Plotting Guide &mdash; gsforge v0.6beta documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/togglebutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/mystnb.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="R Integration" href="R_integration.html" />
    <link rel="prev" title="Interface Guide" href="Interface_Guide.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> gsforge
          

          
          </a>

          
            
            
              <div class="version">
                0.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">User Guide / Tutorial:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html"> Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="tour.html"> Tour</a></li>
<li class="toctree-l1"><a class="reference internal" href="gem_creation.html"> Annotated Expression Matrix Creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="set_and_collection_creation.html"> Set and Collection Creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Interface_Guide.html"> Interface Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"> Plotting Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="R_integration.html"> R Integration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="analysis_resources.html"> Analysis Resources</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference_examples/plot_gallery/ref_plots.html"> Reference Plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_examples/Normalizations/norm_index.html"> Normalization Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Walkthroughs:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../walkthroughs/oryza_sativa/oryza_sativa_index.html"> Oryza sativa</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../API/modules.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">gsforge</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Plotting Guide</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/user_guide/Plotting_Guide.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="plotting-guide">
<h1>Plotting Guide<a class="headerlink" href="#plotting-guide" title="Permalink to this headline">¶</a></h1>
<p>This notebook describes the types of plotting functions included with <code class="docutils literal notranslate"><span class="pre">GSForge</span></code>,
as well as how to apply customizations to those plots.</p>
<p>Plot source data delineates the plotting functions.</p>
<ul class="simple">
<li><p><strong>gem</strong> the count array from an <code class="docutils literal notranslate"><span class="pre">AnnotatedGEM</span></code> or the same via a <code class="docutils literal notranslate"><span class="pre">GeneSetCollection</span></code>.</p></li>
<li><p><strong>collections</strong> based on membership of <code class="docutils literal notranslate"><span class="pre">GeneSet</span></code> objects within a <code class="docutils literal notranslate"><span class="pre">GeneSetCollection</span></code>.</p></li>
<li><p><strong>results</strong> Custom functions for specific analytical methods, e.g. volcano plots for DGE analysis.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">GSForge</span></code> uses the <code class="docutils literal notranslate"><span class="pre">Holoviews</span></code> package for creating plots.
<code class="docutils literal notranslate"><span class="pre">Holoviews</span></code> is a common API to create plots using two popular backends, <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> and <code class="docutils literal notranslate"><span class="pre">bokeh</span></code>.</p>
<p><em><strong>Plotting Guide Setup</strong></em></p>
<p>A shared setup for all plotting guides.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># OS-independent path management.</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">environ</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">GSForge</span> <span class="k">as</span> <span class="nn">gsf</span>
<span class="kn">import</span> <span class="nn">holoviews</span> <span class="k">as</span> <span class="nn">hv</span>
<span class="n">hv</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="s1">&#39;bokeh&#39;</span><span class="p">,</span> <span class="s1">&#39;matplotlib)</span>

<span class="n">OSF_PATH</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;GSFORGE_DEMO_DATA&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;~/GSForge_demo_data/&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;osfstorage&quot;</span><span class="p">,</span> <span class="s2">&quot;oryza_sativa&quot;</span><span class="p">)</span>
<span class="n">NORMED_GEM_PATH</span> <span class="o">=</span> <span class="n">OSF_PATH</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;AnnotatedGEMs&quot;</span><span class="p">,</span> <span class="s2">&quot;oryza_sativa_hydro_hisat2_normed.nc&quot;</span><span class="p">)</span>
<span class="n">TOUR_BORUTA</span> <span class="o">=</span> <span class="n">OSF_PATH</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;GeneSetCollections&quot;</span><span class="p">,</span> <span class="s2">&quot;tour_boruta&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">  File</span><span class="nn"> &quot;/tmp/ipykernel_5876/1680162355.py&quot;</span><span class="gt">, line </span><span class="mi">7</span>
    <span class="n">hv</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="s1">&#39;bokeh&#39;</span><span class="p">,</span> <span class="s1">&#39;matplotlib)</span>
                                      <span class="o">^</span>
<span class="ne">SyntaxError</span>: EOL while scanning string literal
</pre></div>
</div>
</div>
</div>
<p>Load an annotated expression matrix and a collection:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agem</span> <span class="o">=</span> <span class="n">gsf</span><span class="o">.</span><span class="n">AnnotatedGEM</span><span class="p">(</span><span class="n">NORMED_GEM_PATH</span><span class="p">)</span>
<span class="n">agem</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gsc</span> <span class="o">=</span> <span class="n">gsf</span><span class="o">.</span><span class="n">GeneSetCollection</span><span class="o">.</span><span class="n">from_folder</span><span class="p">(</span>
    <span class="n">gem</span><span class="o">=</span><span class="n">agem</span><span class="p">,</span> <span class="n">target_dir</span><span class="o">=</span><span class="n">TOUR_BORUTA</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Boruta Results&quot;</span><span class="p">)</span>
<span class="n">gsc</span>
</pre></div>
</div>
</div>
</div>
<p>Select a backend, or load only the one you wish to use.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hv</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s2">&quot;matplotlib&quot;</span><span class="p">)</span>
<span class="n">gsf</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">gem</span><span class="o">.</span><span class="n">GenewiseAggregateScatter</span><span class="p">(</span><span class="n">agem</span><span class="p">,</span> <span class="n">datashade</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">apply_default_opts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hv</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s2">&quot;bokeh&quot;</span><span class="p">)</span>
<span class="n">gsf</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">gem</span><span class="o">.</span><span class="n">GenewiseAggregateScatter</span><span class="p">(</span><span class="n">agem</span><span class="p">,</span> <span class="n">datashade</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="saving-plots">
<h2>Saving Plots<a class="headerlink" href="#saving-plots" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hv</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">my_plot</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">toolbar</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>  <span class="c1"># This sometimes does not remove the toolbar.</span>
        <span class="s2">&quot;my_filename.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Where to go for more help?</strong></p>
<p>See the excellent <a class="reference external" href="http://holoviews.org/">Holoviews documentation</a> for more on creating and styling plots.</p>
<p><strong>How to return a plot with no styling applied</strong></p>
<p>It is then up to you to modify the <code class="docutils literal notranslate"><span class="pre">holoviews</span></code> object, and to apply desired options from your selected backend.</p>
<p>All <code class="docutils literal notranslate"><span class="pre">GSForge</span></code> plotting functions have an <code class="docutils literal notranslate"><span class="pre">apply_default_opts</span></code>, which attempts to apply options based on
the currently loaded backend extension.
If you want to apply your own styling, plots can be returned with their default settings only by setting
<code class="docutils literal notranslate"><span class="pre">apply_default_opts=False</span></code>.</p>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="R_integration.html" class="btn btn-neutral float-right" title="R Integration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Interface_Guide.html" class="btn btn-neutral float-left" title="Interface Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Tyler Biggs, Stephen Ficklin.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>